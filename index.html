<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Assembly Tracking</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f2f2f2;
  padding: 20px;
  margin: 0;
}

.card {
  max-width: 560px;
  margin: auto;
  background: #fff;
  padding: 22px;
  border-radius: 16px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.12);
}

.logo {
  display: block;
  max-width: 180px;
  margin: 0 auto 10px;
}

h1 {
  text-align: center;
  margin: 6px 0 14px;
}

.instructions {
  background: #f6f6f6;
  padding: 14px;
  border-radius: 12px;
  font-size: 14px;
  margin-bottom: 16px;
}

label {
  font-weight: bold;
  display: block;
  margin-top: 14px;
}

input, select, textarea {
  width: 100%;
  padding: 12px;
  font-size: 16px;
  border-radius: 10px;
  border: 1px solid #ccc;
  margin-top: 6px;
}

select[multiple] {
  height: 150px;
}

.dishes {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 10px;
  margin-top: 10px;
}

.dish {
  border: 2px solid #6b46c1;
  border-radius: 10px;
  padding: 8px;
  text-align: center;
}

.dish button {
  width: 100%;
  padding: 10px 0;
  font-size: 18px;
  font-weight: bold;
  border: none;
  background: #f5f5f5;
  cursor: pointer;
  border-radius: 8px;
}

.dish button.active {
  background: #6b46c1;
  color: white;
}

.qty {
  display: none;
  margin-top: 6px;
}

.qty input {
  padding: 6px;
  font-size: 14px;
  text-align: center;
}

.submit-btn {
  margin-top: 22px;
  width: 100%;
  padding: 16px;
  font-size: 18px;
  border-radius: 12px;
  border: none;
  background: #6b46c1;
  color: white;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="card">

  <img src="https://bellabona.com/hubfs/logo-bellabona.svg" class="logo">

  <h1>Assembly Tracking</h1>

  <div class="instructions">
    1. Select date<br>
    2. Select all employees who worked together<br>
    3. Select dish letters (A–Z) & quantities<br>
    4. Submit (multiple submissions allowed)
  </div>

  <form onsubmit="submitForm(event)">

    <label>Date</label>
    <input type="date" id="date" required>

    <label>Employees (multi-select)</label>
    <select id="employees" multiple required>
      <option>Joel</option>
      <option>Richa</option>
      <option>Jash</option>
      <option>Hamid</option>
      <option>Varush</option>
      <option>Ranjith</option>
      <option>Salman</option>
    </select>

    <label>Dishes (A–Z)</label>
    <div class="dishes" id="dishes"></div>

    <label>Role</label>
    <select id="role" required>
      <option>Main</option>
      <option>Assist</option>
      <option>Support</option>
    </select>

    <label>Comment (optional)</label>
    <textarea id="comment" rows="3"></textarea>

    <button class="submit-btn" type="submit">Submit</button>
  </form>

</div>

<script>
document.getElementById("date").valueAsDate = new Date();
const dishesContainer = document.getElementById("dishes");

// Create A–Z dishes
for (let i = 65; i <= 90; i++) {
  const letter = String.fromCharCode(i);

  const wrap = document.createElement("div");
  wrap.className = "dish";

  const btn = document.createElement("button");
  btn.type = "button";
  btn.textContent = letter;

  const qtyDiv = document.createElement("div");
  qtyDiv.className = "qty";
  qtyDiv.innerHTML = '<input type="number" min="1" placeholder="Qty">';

  btn.onclick = () => {
    btn.classList.toggle("active");
    qtyDiv.style.display = btn.classList.contains("active") ? "block" : "none";
    if (!btn.classList.contains("active")) qtyDiv.querySelector("input").value = "";
  };

  wrap.appendChild(btn);
  wrap.appendChild(qtyDiv);
  dishesContainer.appendChild(wrap);
}

function submitForm(e) {
  e.preventDefault();

  const employees = [...employees.selectedOptions].map(o => o.value);
  if (!employees.length) return alert("Select at least one employee");

  const selectedDishes = [];
  document.querySelectorAll(".dish").forEach(d => {
    const b = d.querySelector("button");
    if (b.classList.contains("active")) {
      const qty = d.querySelector("input").value;
      if (!qty) return alert("Enter quantity for " + b.textContent);
      selectedDishes.push({ letter: b.textContent, qty });
    }
  });

  if (!selectedDishes.length) return alert("Select at least one dish");

  // send one row per dish
  selectedDishes.forEach(dish => {
    fetch("https://script.google.com/macros/s/AKfycbw3W1NNlbP9cuT9pc-JP8qY4sQWb19Izv9_9eWg2R1-kvsQsDTqdCfMCBSC2KwkRPe29w/exec", {
      method: "POST",
      body: JSON.stringify({
        date: date.value,
        employees: employees.join(", "),
        dish: dish.letter,
        quantity: dish.qty,
        role: role.value,
        comment: comment.value
      })
    });
  });

  alert("Submitted successfully ✔");

  document.querySelector("form").reset();
  document.querySelectorAll(".qty").forEach(q => q.style.display = "none");
  document.querySelectorAll(".dish button").forEach(b => b.classList.remove("active"));
}
</script>

</body>
</html>

